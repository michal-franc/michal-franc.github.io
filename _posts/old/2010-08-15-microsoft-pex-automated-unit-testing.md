---
layout: post
title: Microsoft Pex – Automated Unit Testing
date: 2010-08-15 20:14
author: Michal Franc

comments: true
categories: []
tags: [archive]
---
<p align="justify"><a href="http://research.microsoft.com/en-us/projects/pex/">Microsoft Pex</a> isa Visual Studio add in, which enables code analysis on the runtime. The great fact about it, is&#160; the ability to generate tests automatically. I analyzed my small project with it check out the results.</p>  <p align="justify">&#160;</p>  <h3 align="justify">Automated Tests</h3>  <p align="justify"><a href="http://lammichalfranc.files.wordpress.com/2010/08/image28.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image" border="0" alt="image" src="http://lammichalfranc.files.wordpress.com/2010/08/image_thumb28.png" width="244" height="230" /></a> </p>  <p align="justify">&#160;</p>  <p align="justify">While analyzing you can watch whole process in <strong>Pex Explorer</strong>. As you can see only two of my classes passed the tests. Rest, well they are in red and that’s a bad sign. The <strong><a href="http://research.microsoft.com/en-us/projects/pex/">Pex</a></strong> created all the tests by itself.</p>  <p align="justify">&#160;</p>  <p align="justify"><a href="http://lammichalfranc.files.wordpress.com/2010/08/image29.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image" border="0" alt="image" src="http://lammichalfranc.files.wordpress.com/2010/08/image_thumb29.png" width="303" height="356" /></a> </p>  <p align="justify">&#160;</p>  <p align="justify"></p>  <p align="justify">On this image you can see all the test cases generated by <strong><a href="http://research.microsoft.com/en-us/projects/pex/">Pex</a></strong> for my Task class. Lets take a closer look at my <strong>TaskBin </strong>class and <strong>CreateFromString </strong>Method.</p>  <p align="justify">&#160;</p>  <p align="justify"><a href="http://lammichalfranc.files.wordpress.com/2010/08/image30.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image" border="0" alt="image" src="http://lammichalfranc.files.wordpress.com/2010/08/image_thumb30.png" width="334" height="218" /></a> <a href="http://lammichalfranc.files.wordpress.com/2010/08/image31.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image" border="0" alt="image" src="http://lammichalfranc.files.wordpress.com/2010/08/image_thumb31.png" width="229" height="218" /></a> </p>  <p align="justify">&#160;</p>  <p align="justify">Left image shows all the performed tests and shows, which failed or passed. On the right image, you can analyze data on which the test was run. You can clearly see on which string the test failed and, which was ok.</p>  <p align="justify">Values used for tests are generated based on the if statements,&#160; assertions, and operations that can throw an exception. The code is first analyzed, and then the values are generated.</p>  <p align="justify">After the tests are generated you can save and store them for later use.</p>  <p align="justify">&#160;</p>  <h3 align="justify">Suggestions</h3>  <p align="justify"><a href="http://lammichalfranc.files.wordpress.com/2010/08/image32.png"><img style="border-bottom:0;border-left:0;display:inline;border-top:0;border-right:0;" title="image" border="0" alt="image" src="http://lammichalfranc.files.wordpress.com/2010/08/image_thumb32.png" width="482" height="242" /></a> </p>  <p align="justify">&#160;</p>  <p align="justify">After the analyze process, <strong><a href="http://research.microsoft.com/en-us/projects/pex/">Pex</a> </strong>also makes suggestions with fixes to encountered problems.</p>  <p align="justify">&#160;</p>  <h3 align="justify">Integration with Various Unit Test Frameworks</h3>  <p align="justify">As a Microsoft product <strong><a href="http://research.microsoft.com/en-us/projects/pex/">Pex</a> </strong>is not only using the MsUnit tests. You can run it with :</p>  <ul>   <li>     <div align="justify"><strong><a href="http://www.nunit.org/">NUnit</a></strong></div>   </li>    <li>     <div align="justify"><strong><a href="http://www.mbunit.com/Default.aspx">MBUnit</a></strong>&#160;</div>   </li> </ul>  <p align="justify">and more.</p>  <p align="justify">I have used the NUnit.</p>  <p align="justify">&#160;</p>  <h3 align="justify">The Future of Unit Testing ?</h3>  <p align="justify">This is quite a nice tool. While writing tests you have to write a lot of code. Pex frees us up from this task,&#160; at least a bit. I think that Pex will be a useful addition and will generate simplest tests. Developer will be able to focus his attention on more complex tests.</p>  <p align="justify">Do you think that the whole process of Unit Testing will be automated?    </p>
