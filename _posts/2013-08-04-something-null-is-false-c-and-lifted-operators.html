---
layout: post
title: Why Something > null is false - C# and Lifted Operators
date: 2013-08-04 10:35:21.000000000 +01:00
categories:
- Programming
tags:
- c#
status: publish
type: post
published: true
meta:
  _yoast_wpseo_linkdex: '0'
  _edit_last: '1'
  _yoast_wpseo_focuskw: ''
  _yoast_wpseo_title: ''
  _yoast_wpseo_metadesc: ''
  _yoast_wpseo_meta-robots-noindex: '0'
  _yoast_wpseo_meta-robots-nofollow: '0'
  _yoast_wpseo_meta-robots-adv: none
  _yoast_wpseo_sitemap-include: "-"
  _yoast_wpseo_sitemap-prio: "-"
  _yoast_wpseo_canonical: ''
  _yoast_wpseo_redirect: ''
  _yoast_wpseo_opengraph-description: ''
  _yoast_wpseo_google-plus-description: ''
  dsq_thread_id: '1567544598'
author:
  login: LaM
  email: lam.michal.franc@gmail.com
  display_name: Michal Franc
  first_name: Michal
  last_name: Franc
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p>In the project, I am working with, there is a simple feature that imports data from external source. Import is only interested in new records. This condition is fulfilled with 'DateTime' comparision.</p>
<pre class="lang:c# decode:true ">if (data.CreateDate =&gt; this.LastUpdateDate)
{
     DoSomething();
}
</pre>
<p>Looks simple, Unfortunately I have encountered a nice 'bug' :). On the first run, import got 0 records and I was sure that this number should be around couple of thousands. It seemed like the if clause returned false. In this scenario, on the first run, LastUpdateDate value is undefined.</p>
<p>The comparision looks like.</p>
<pre class="lang:c# decode:true ">Something =&gt; Nothing == false</pre>
<p>Weird, especially when you know that 'DateTime' is a struct and can't be null. It's default value is '0001-01-01 00:00:00'. This comparision should evaluate to true right ? Sadly there is one catch. LastUpdateDate is a 'DateTime?' type. I assumed that both operands are of 'DateTime' type. Nullable DateTime is whole different story.</p>
<p>The comparision changes to</p>
<pre class="lang:c# decode:true ">DateTime &gt; DateTime?</pre>
<p>Default value of DateTime? is null, It is then.</p>
<pre class="lang:c# decode:true ">DateTime.Now &gt; null</pre>
<p>Let's see what the result of this comparision.</p>
<pre class="lang:c# decode:true ">public class DateTimeTest
{
        public DateTime Date { get; set; }
}

void Main()
{
     var result = DateTime.Now &gt; new DateTimeTest().Date;
       Console.WriteLine(result);
}</pre>
<p>Simple class, with only one property a 'DateTime' struct. Result is <strong>'True'</strong>, because DateTime.Now > default(DateTime).</p>
<p>Now let's check what happens if there is a DateTime? property.</p>
<pre class="lang:c# decode:true ">public class NullableDateTimeTest
{
        public DateTime? Date { get; set;}
}

void Main()
{
     var result = DateTime.Now &gt; new NullableDateTimeTest().Date;
       Console.WriteLine(result);
}</pre>
<p>Default Date value is null and the result is <strong>'False'</strong>.</p>
<h3>What is happening when we want to compare Non-nullable type with Nullable type ?</h3>
<p>There is a special kind of behaviour for this case. <a href="http://en.csharp-online.net/ECMA-334%3A_14.2.7_Lifted_operators">In C# specification 14.2.7 Lifted Operators</a></p>
<blockquote><p>Lifted operators permit predefined and user-defined operators that operate on non-nullable value types to also be used with nullable forms of those types.</p></blockquote>
<p>Check out this excellent description of lifted operators <a href="http://stackoverflow.com/a/3370150">by Jon Skeet</a>.</p>
<h3>Why something > null is false</h3>
<p>It seems like this is a design choice. In the <a href="http://en.csharp-online.net/ECMA-334%3A_14.2.7_Lifted_operators">specification</a> you can find this:</p>
<blockquote><p> The lifted operator produces the value false if one or both operands are null.</p></blockquote>
