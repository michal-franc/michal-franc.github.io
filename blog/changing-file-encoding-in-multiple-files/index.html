<!DOCTYPE html>
<html>
    <head>

    
    <meta name="robots" content="all">
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="author" content="Michal Franc">
    <meta name="keywords" content="michal franc,leader,programmer,coach,speaker">
	<title>Changing File Encoding in multiple Files | Michal Franc</title>
	<meta name="description" content="In one of the projects developed in my firm we had encoding set on almost all the files to Something like CodeBase 1252 which supports only the limited set o...">

    <link href="https://fonts.googleapis.com/css?family=Inconsolata:700|Raleway" rel="stylesheet">
    <link rel="profile" href="http://gmpg.org/xfn/11">
    <link rel="author" href="https://plus.google.com/104238159697387202725?rel=author">

	<link rel="canonical" href="http://www.mfranc.com/blog/changing-file-encoding-in-multiple-files/">

    <link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" type="text/css" href="/css/sm.css" media="screen" />
    <link rel="alternate" type="application/rss+xml" title="Michal Franc | Feed" href="http://feeds.feedburner.com/PassionateProgram">

    <meta property="og:locale" content="en_US">
    <meta property="og:title" content="Changing File Encoding in multiple Files | Michal Franc">
    <meta property="og:description" content="In one of the projects developed in my firm we had encoding set on almost all the files to Something like CodeBase 1252 which supports only the limited set o...">
	<meta property="og:url" content="http://www.mfranc.com/blog/changing-file-encoding-in-multiple-files/">
    <meta property="og:site_name" content="Michal Franc Blog">
    <meta property="og:type" content="website">
	<meta property="og:image" content="http://michal-franc.github.io/images/default_share_image.jpg">

	<meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Changing File Encoding in multiple Files | Michal Franc">
    <meta name="twitter:site" content="@francmichal">
    <meta name="twitter:creator" content="@francmichal">
    <meta name="twitter:description" content="In one of the projects developed in my firm we had encoding set on almost all the files to Something like CodeBase 1252 which supports only the limited set o...">
	<meta name="twitter:image" content="http://michal-franc.github.io/images/default_share_image.jpg">

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-15894596-3', 'auto');
  ga('send', 'pageview');
</script>

    <script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(100563098); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100563098ns.gif" /></p></noscript>

    <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

    <!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1817837425153843'); // Insert your pixel ID here.
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1817837425153843&ev=PageView&noscript=1"
/></noscript>
<!-- DO NOT MODIFY -->
<!-- End Facebook Pixel Code -->


  </head>


  <body>
    <main>
      <header class="site-header">
  <div class="container">
	  <h1><a href="/">Michal<span>Franc</span></a></h1>

    <button type="button" class="sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="navbar sliding-panel-content">
      <ul>
        
          <li><a href="/blog" title="Posts">Posts</a></li>
        
          <li><a href="/notes" title="Notes">Notes</a></li>
        
          <li><a href="/articles" title="Articles">Articles</a></li>
        
          <li><a href="/about" title="About">About</a></li>
        
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i></a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="sliding-panel-fade-screen"></div>


      <div class="container">
        <article role="article" class="post">

  <div class="card">
    <header class="post-header">
      <h1 class="post-title">Changing File Encoding in multiple Files</h1>
      <p class="post-meta">Nov 9, 2011 • Michal Franc - 
		<small>
			<i class="icon icon-comments"></i><span class="disqus-comment-count" data-disqus-url="http://mfranc.com/blog/changing-file-encoding-in-multiple-files/"></span>
		</small>
		<small>
			
		</small>
	  </p>
    </header>

	<center>
		
	</center>

    <div class="post-content">
      
      <p>In one of the projects developed in my firm we had encoding set on almost all the files to Something like <strong>CodeBase 1252</strong> which supports only the limited set of characters.</p>

<p>There was a problem with Swedish characters <strong>“ö,ä,å”</strong> and also especially pound currency character which was used in one of the regular expression in the app. With my operating system, configured with the English culture settings using <strong>CodeBase 1250</strong>, those characters where changed and there were couple of runtime errors. We had to change the encoding to <strong>UTF8</strong> that’s one of the solutions. <strong>UTF8</strong> has a bigger character set.</p>

<p>There is an option in <strong>Visual Studio File –&gt; Advanced Save Options </strong> that can be used to change <strong>encoding</strong> but it’s only usable for scenarios with one file. In this situation I had to change couple thousand of files. To fix this problem I have found a nice solution that uses <strong>PowerShell</strong> .</p>

<p>Script:</p>

<figure class="highlight">
  <pre><code class="language-csharp" data-lang="csharp"><span class="n">function</span> <span class="nf">ChangeEncoding</span> <span class="p">(</span><span class="err">$</span><span class="n">baseDirectory</span><span class="p">)</span>
<span class="p">{</span>
        <span class="err">$</span><span class="n">allFiles</span> <span class="p">=</span> <span class="n">Get</span><span class="p">-</span><span class="n">ChildItem</span> <span class="err">$</span><span class="n">baseDirectory</span> <span class="p">-</span><span class="n">include</span> <span class="p">*.</span><span class="n">aspx</span><span class="p">,*.</span><span class="n">ascx</span> <span class="p">-</span><span class="n">recurse</span> 
               <span class="p">|</span> <span class="k">where</span><span class="p">-</span><span class="kt">object</span> <span class="p">{</span> <span class="p">-</span><span class="n">not</span> <span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">PSIsContainer</span><span class="p">}</span>
        <span class="k">foreach</span><span class="p">(</span> <span class="err">$</span><span class="n">file</span> <span class="k">in</span> <span class="err">$</span><span class="n">allFiles</span><span class="p">){</span>
            <span class="err">$</span><span class="n">fileContent</span> <span class="p">=</span> <span class="k">get</span><span class="p">-</span><span class="n">content</span> <span class="err">$</span><span class="n">file</span><span class="p">.</span><span class="n">FullName</span> <span class="p">-</span><span class="n">force</span>
            <span class="err">$</span><span class="n">fileContent</span> <span class="p">|</span> <span class="k">set</span><span class="p">-</span><span class="n">content</span> <span class="p">-</span><span class="n">encoding</span> <span class="n">utf8</span>  <span class="err">$</span><span class="n">file</span><span class="p">.</span><span class="n">FullName</span> <span class="p">-</span><span class="n">force</span>
         <span class="p">}</span>
<span class="p">}</span>
<span class="nf">ChangeEncoding</span><span class="p">(</span><span class="s">"BaseDirectoryPath"</span><span class="p">)</span></code></pre>
</figure>

<p>This script iterates through all the files in directories and their directories and rewrites them with correct encoding. It’s not the best solution but it works.</p>

<p>Little Explanation:</p>

<p><span style="background-color: red;">Get-ChildItem $baseDirectory -include <em>.aspx,</em>.ascx –recurse</span></p>

<p>Gets all the files with specified extensions  (aspx and ascx) , recurse option enables search through all the files in directories and subdirectories</p>

<p><span style="background-color: red;">where-object { -not $_.PSIsContainer}</span></p>

<p>Used to exclude directories from the files list.</p>

<p>This script loads the file to a temporary variable because we have to read and write the same file. Pipelined solution would be cleaner but it reads and writes the data one line at time. You can’t write and read on the same file at the same time.</p>

      <span id="post-end"></span>
    </div>

    <div id="mc_embed_signup">
<form action="https://mfranc.us13.list-manage.com/subscribe/post?u=8a5865e28c59044d419ecbe95&amp;id=d545f31150" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
      <label for="mce-EMAIL">If you are interested in Cloud Native, Scalability, System Design and more meaty side of Engineering at Scale. Then subscribe to my mailing list.</label>
      <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
        <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_8a5865e28c59044d419ecbe95_d545f31150" tabindex="-1" value=""></div>
        <div class="clear">
          <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
        </div>
    </div>
</form>
</div>



    
<hr>

<aside id="comments" class="disqus">
  <div class="container">
    <h3><i class="icon icon-comments-o"></i> Comments</h3>
    <div id="disqus_thread"></div>
    <script>
      (function() {
        var d = document,
        s = d.createElement('script');
        s.src = '//thesilenceofthelams.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</aside>



  </div>

</article>

      </div>


      <footer class="site-footer">
  <div class="container">
    <ul class="social">
  <li><a href="http://github.com/michal-franc" target="_blank"><i class="icon icon-github"></i></a></li>
  <li><a href="http://twitter.com/francmichal" target="_blank"><i class="icon icon-twitter"></i></a></li>
  <li><a href="http://facebook.com/michalfrancblog" target="_blank"><i class="icon icon-facebook"></i></a></li>
  <li><a href="https://uk.linkedin.com/in/michalfranc1" target="_blank"><i class="icon icon-linkedin"></i></a></li>
</ul>

    <p class="txt-medium-gray">
      <small>&copy;2018 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small>
    </p>
  </div>
</footer>


      <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	  <script type="text/javascript" src="/js/jquery.slick-modals.js"/></script>

	  <!-- <script id="ulp-remote" src="http://tools.mfranc.com/wp-content/plugins/layered-popups/js/remote.min.js?ver=5.89" data-handler="http://tools.mfranc.com/wp-admin/admin-ajax.php"></script>
	  <script>

		    (function ($) {
			"use strict";
			var objectPositionTop = $('#post-end').offset().top - window.innerHeight;

				ulp_add_event("onexit", {
					popup:		"4AXWiVSrZD71uqiP",
					mode:		"once-period",
					period:		30
				});

				ulp_add_event("onidle", {
					popup:		"85oltSbndJGZQzaW",
					mode:		"once-period",
					period:         30
				});

				ulp_add_event("onscroll", {
					popup:		"INyhHrwTzxjvcqEb",
					mode:		"once-period",
					period:         30,
					offset:		objectPositionTop / 2
				});

		    }(jQuery));

    </script> -->

		<script id="dsq-count-scr" src="//thesilenceofthelams.disqus.com/count.js" async></script>

		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.7&appId=125980610784627";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
    </main>
  </body>
</html>
